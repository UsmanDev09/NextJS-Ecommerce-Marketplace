{"version":3,"file":"react-ranger.production.min.js","sources":["../src/index.js"],"sourcesContent":["import React from 'react'\n\nconst getBoundingClientRect = element => {\n  const rect = element.getBoundingClientRect()\n  return {\n    left: Math.ceil(rect.left),\n    width: Math.ceil(rect.width),\n  }\n}\n\nconst sortNumList = arr => [...arr].sort((a, b) => Number(a) - Number(b))\n\nconst useGetLatest = val => {\n  const ref = React.useRef(val)\n  ref.current = val\n  return React.useCallback(() => ref.current, [])\n}\n\nconst linearInterpolator = {\n  getPercentageForValue: (val, min, max) => {\n    return Math.max(0, Math.min(100, ((val - min) / (max - min)) * 100))\n  },\n  getValueForClientX: (clientX, trackDims, min, max) => {\n    const { left, width } = trackDims\n    const percentageValue = (clientX - left) / width\n    const value = (max - min) * percentageValue\n    return value + min\n  },\n}\n\nexport function useRanger({\n  interpolator = linearInterpolator,\n  tickSize = 10,\n  values,\n  min,\n  max,\n  ticks: controlledTicks,\n  steps,\n  onChange,\n  onDrag,\n  stepSize,\n}) {\n  const [activeHandleIndex, setActiveHandleIndex] = React.useState(null)\n  const [tempValues, setTempValues] = React.useState()\n\n  const getLatest = useGetLatest({\n    activeHandleIndex,\n    onChange,\n    onDrag,\n    values,\n    tempValues,\n  })\n\n  const trackElRef = React.useRef()\n\n  const getValueForClientX = React.useCallback(\n    clientX => {\n      const trackDims = getBoundingClientRect(trackElRef.current)\n      return interpolator.getValueForClientX(clientX, trackDims, min, max)\n    },\n    [interpolator, max, min]\n  )\n\n  const getNextStep = React.useCallback(\n    (val, direction) => {\n      if (steps) {\n        let currIndex = steps.indexOf(val)\n        let nextIndex = currIndex + direction\n        if (nextIndex >= 0 && nextIndex < steps.length) {\n          return steps[nextIndex]\n        } else {\n          return val\n        }\n      } else {\n        if (process.env.NODE_ENV !== 'production') {\n          if (typeof stepSize === 'undefined') {\n            throw new Error(\n              'Warning: The option `stepSize` is expected in `useRanger`, but its value is `undefined`'\n            )\n          }\n        }\n        let nextVal = val + stepSize * direction\n        if (nextVal >= min && nextVal <= max) {\n          return nextVal\n        } else {\n          return val\n        }\n      }\n    },\n    [max, min, stepSize, steps]\n  )\n\n  const roundToStep = React.useCallback(\n    val => {\n      let left = min\n      let right = max\n      if (steps) {\n        steps.forEach(step => {\n          if (step <= val && step > left) {\n            left = step\n          }\n          if (step >= val && step < right) {\n            right = step\n          }\n        })\n      } else {\n        if (process.env.NODE_ENV !== 'production') {\n          if (typeof stepSize === 'undefined') {\n            throw new Error(\n              'Warning: The option `stepSize` is expected in `useRanger`, but its value is `undefined`'\n            )\n          }\n        }\n        while (left < val && left + stepSize < val) {\n          left += stepSize\n        }\n\n        right = Math.min(left + stepSize, max)\n      }\n\n      if (val - left < right - val) {\n        return left\n      }\n      return right\n    },\n    [max, min, stepSize, steps]\n  )\n\n  const handleDrag = React.useCallback(\n    e => {\n      const { activeHandleIndex, onDrag } = getLatest()\n      const clientX =\n        e.type === 'touchmove' ? e.changedTouches[0].clientX : e.clientX\n      const newValue = getValueForClientX(clientX)\n      const newRoundedValue = roundToStep(newValue)\n\n      const newValues = [\n        ...values.slice(0, activeHandleIndex),\n        newRoundedValue,\n        ...values.slice(activeHandleIndex + 1),\n      ]\n\n      if (onDrag) {\n        onDrag(newValues)\n      } else {\n        setTempValues(newValues)\n      }\n    },\n    [getLatest, getValueForClientX, roundToStep, values]\n  )\n\n  const handleKeyDown = React.useCallback(\n    (e, i) => {\n      const { values, onChange = () => {} } = getLatest()\n      // Left Arrow || Right Arrow\n      if (e.keyCode === 37 || e.keyCode === 39) {\n        setActiveHandleIndex(i)\n        const direction = e.keyCode === 37 ? -1 : 1\n        const newValue = getNextStep(values[i], direction)\n        const newValues = [\n          ...values.slice(0, i),\n          newValue,\n          ...values.slice(i + 1),\n        ]\n        const sortedValues = sortNumList(newValues)\n        onChange(sortedValues)\n      }\n    },\n    [getLatest, getNextStep]\n  )\n\n  const handlePress = React.useCallback(\n    (e, i) => {\n      setActiveHandleIndex(i)\n\n      const handleRelease = e => {\n        const {\n          tempValues,\n          values,\n          onChange = () => {},\n          onDrag = () => {},\n        } = getLatest()\n\n        document.removeEventListener('mousemove', handleDrag)\n        document.removeEventListener('touchmove', handleDrag)\n        document.removeEventListener('mouseup', handleRelease)\n        document.removeEventListener('touchend', handleRelease)\n        const sortedValues = sortNumList(tempValues || values)\n        onChange(sortedValues)\n        onDrag(sortedValues)\n        setActiveHandleIndex(null)\n        setTempValues()\n      }\n\n      document.addEventListener('mousemove', handleDrag)\n      document.addEventListener('touchmove', handleDrag)\n      document.addEventListener('mouseup', handleRelease)\n      document.addEventListener('touchend', handleRelease)\n    },\n    [getLatest, handleDrag]\n  )\n\n  const getPercentageForValue = React.useCallback(\n    val => interpolator.getPercentageForValue(val, min, max),\n    [interpolator, max, min]\n  )\n\n  // Build the ticks\n  const ticks = React.useMemo(() => {\n    let ticks = controlledTicks || steps\n\n    if (!ticks) {\n      ticks = [min]\n      while (ticks[ticks.length - 1] < max - tickSize) {\n        ticks.push(ticks[ticks.length - 1] + tickSize)\n      }\n      ticks.push(max)\n    }\n\n    return ticks.map((value, i) => ({\n      value,\n      getTickProps: ({ key = i, style = {}, ...rest } = {}) => ({\n        key,\n        style: {\n          position: 'absolute',\n          width: 0,\n          left: `${getPercentageForValue(value)}%`,\n          transform: `translateX(-50%)`,\n          ...style,\n        },\n        ...rest,\n      }),\n    }))\n  }, [controlledTicks, getPercentageForValue, max, min, steps, tickSize])\n\n  const segments = React.useMemo(() => {\n    const sortedValues = sortNumList(tempValues || values)\n\n    return [...sortedValues, max].map((value, i) => ({\n      value,\n      getSegmentProps: ({ key = i, style = {}, ...rest } = {}) => {\n        const left = getPercentageForValue(\n          sortedValues[i - 1] ? sortedValues[i - 1] : min\n        )\n        const width = getPercentageForValue(value) - left\n        return {\n          key,\n          style: {\n            position: 'absolute',\n            left: `${left}%`,\n            width: `${width}%`,\n            ...style,\n          },\n          ...rest,\n        }\n      },\n    }))\n  }, [getPercentageForValue, max, min, tempValues, values])\n\n  const handles = React.useMemo(\n    () =>\n      (tempValues || values).map((value, i) => ({\n        value,\n        active: i === activeHandleIndex,\n        getHandleProps: ({\n          key = i,\n          ref,\n          innerRef = () => {},\n          onKeyDown,\n          onMouseDown,\n          onTouchStart,\n          style = {},\n          ...rest\n        } = {}) => ({\n          key,\n          onKeyDown: e => {\n            e.persist()\n            handleKeyDown(e, i)\n            if (onKeyDown) onKeyDown(e)\n          },\n          onMouseDown: e => {\n            e.persist()\n            handlePress(e, i)\n            if (onMouseDown) onMouseDown(e)\n          },\n          onTouchStart: e => {\n            e.persist()\n            handlePress(e, i)\n            if (onTouchStart) onTouchStart(e)\n          },\n          role: 'slider',\n          'aria-valuemin': min,\n          'aria-valuemax': max,\n          'aria-valuenow': value,\n          style: {\n            position: 'absolute',\n            top: '50%',\n            left: `${getPercentageForValue(value)}%`,\n            zIndex: i === activeHandleIndex ? '1' : '0',\n            transform: 'translate(-50%, -50%)',\n            ...style,\n          },\n          ...rest,\n        }),\n      })),\n    [\n      activeHandleIndex,\n      getPercentageForValue,\n      handleKeyDown,\n      handlePress,\n      min,\n      max,\n      tempValues,\n      values,\n    ]\n  )\n\n  const getTrackProps = ({ style = {}, ref, ...rest } = {}) => {\n    return {\n      ref: el => {\n        trackElRef.current = el\n        if (ref) {\n          if (typeof ref === 'function') {\n            ref(el)\n          } else {\n            ref.current = el\n          }\n        }\n      },\n      style: {\n        position: 'relative',\n        userSelect: 'none',\n        ...style,\n      },\n      ...rest,\n    }\n  }\n\n  return {\n    activeHandleIndex,\n    getTrackProps,\n    ticks,\n    segments,\n    handles,\n  }\n}\n"],"names":["sortNumList","arr","sort","a","b","Number","linearInterpolator","getPercentageForValue","val","min","max","Math","getValueForClientX","clientX","trackDims","left","width","ref","interpolator","tickSize","values","controlledTicks","ticks","steps","onChange","onDrag","stepSize","React","useState","activeHandleIndex","setActiveHandleIndex","tempValues","setTempValues","getLatest","useRef","current","useCallback","trackElRef","element","rect","getBoundingClientRect","ceil","getNextStep","direction","nextIndex","indexOf","length","nextVal","roundToStep","right","forEach","step","handleDrag","e","type","changedTouches","newValue","newRoundedValue","newValues","slice","handleKeyDown","i","keyCode","handlePress","handleRelease","document","removeEventListener","sortedValues","addEventListener","useMemo","push","map","value","getTickProps","key","style","rest","position","transform","segments","getSegmentProps","handles","active","getHandleProps","onKeyDown","innerRef","onMouseDown","onTouchStart","persist","role","top","zIndex","getTrackProps","el","userSelect"],"mappings":"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"}